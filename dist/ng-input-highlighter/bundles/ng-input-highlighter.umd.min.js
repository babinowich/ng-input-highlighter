!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/platform-browser")):"function"==typeof define&&define.amd?define("ng-input-highlighter",["exports","@angular/core","rxjs","rxjs/operators","@angular/platform-browser"],e):e(t["ng-input-highlighter"]={},t.ng.core,t.rxjs,t.rxjs.operators,t.ng.platformBrowser)}(this,function(t,e,n,i,o){"use strict";var r=function(){function t(){}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=e.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();function m(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}var s=function(){function t(t){this.renderer=t,this.targetItems=[],this.localAnalysis=!0,this.boxHeight="M",this.fontClass="regularText",this.boxClass="none",this.boxFocus="focused",this.initFocus=!0,this.caseSensitive=!1,this.currentText=new e.EventEmitter,this.textSubject=new n.Subject,this.responsePending=!1,this.textArray=[],this.tempString=""}return t.prototype.ngOnInit=function(){var e=this;this.textSubject.pipe(i.debounceTime(2e3)).subscribe(function(t){console.log(t),e.responsePending=!0,e.currentText.emit(e.tempString),e.localAnalysis&&(e.constructLocally(),setTimeout(function(){e.responsePending=!1,e.focusInput()},500))}),"XS"===this.boxHeight?this.boxSize="xsmall":"S"===this.boxHeight?this.boxSize="small":"L"===this.boxHeight?this.boxSize="large":"XL"===this.boxHeight?this.boxSize="xlarge":this.boxSize="medium"},t.prototype.ngOnChanges=function(t){var e=this;0<this.targetItems.length&&!this.localAnalysis&&t.targetItems&&(this.constructExternally(),setTimeout(function(){e.responsePending=!1,e.focusInput()},500))},t.prototype.ngAfterViewInit=function(){var t=this;this.renderer.listen(this.lastInput.nativeElement,"focus",function(){t.renderer.addClass(t.inputBox.nativeElement,t.boxFocus)}),this.renderer.listen(this.lastInput.nativeElement,"blur",function(){t.renderer.removeClass(t.inputBox.nativeElement,t.boxFocus)}),this.initFocus&&this.focusInput(),console.log("targetItems",this.targetItems)},t.prototype.textChange=function(t){this.tempString=t,this.textSubject.next(t)},t.prototype.constructLocally=function(){var t='<span class="'+this.fontClass+'">',e=function x(t,e,n){var i,o,r=[];try{for(var s=m(t),a=s.next();!a.done;a=s.next()){var l=a.value,c=0,u=void 0,p=l.text.length;if(0===p)return"An error occurred. There appears to be no input search string.";var h=void 0,g=void 0;for(g=n?(h=e,l.text):(h=e.toLowerCase(),l.text.toLowerCase());-1<(u=h.indexOf(g,c));){var f={text:e.substring(u,u+p),location:[u,u+p],css:l.css};r.push(f),c=u+p}}}catch(d){i={error:d}}finally{try{a&&!a.done&&(o=s["return"])&&o.call(s)}finally{if(i)throw i.error}}return 0===r.length?e:y(r,e)}(this.targetItems,this.tempString,this.caseSensitive);this.textHTMLstring=t+e+" </span>"},t.prototype.constructExternally=function(){var t,e,n,i,o='<span class="'+this.fontClass+'">',r=!0,s=[];if(0===this.targetItems.length)this.textHTMLstring=o+this.tempString+" </span>";else{try{for(var a=m(this.targetItems),l=a.next();!l.done;l=a.next()){(g=l.value).location||(s.push(g),r=!1)}}catch(f){t={error:f}}finally{try{l&&!l.done&&(e=a["return"])&&e.call(a)}finally{if(t)throw t.error}}if(r){var c=y(this.targetItems,this.tempString);this.textHTMLstring=o+c+" </span>"}else{var u="";try{for(var p=m(s),h=p.next();!h.done;h=p.next()){var g;u=u+(g=h.value).text+"  "}}catch(d){n={error:d}}finally{try{h&&!h.done&&(i=p["return"])&&i.call(p)}finally{if(n)throw n.error}}this.textHTMLstring="An error occured.  The following items did not have a valid identified index location: "+u+"Either provide proper index locations of each item to be highlighted or set localAnalysis to true."}}},t.prototype.focusInput=function(){console.log("focus"),this.lastInput&&(this.lastInput.nativeElement.focus(),this.placeCaretAtEnd(this.lastInput.nativeElement))},t.prototype.placeCaretAtEnd=function(t){if(t.focus(),"undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var e=document.createRange();e.selectNodeContents(t),e.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(e)}},t.prototype.selectAll=function(){document.execCommand("selectAll",!1,null)},t.decorators=[{type:e.Component,args:[{selector:"lib-ng-input-highlighter",template:'<div #inputBox id="input-area" tabindex="0" [ngClass]="[boxSize, boxClass]">\n  <div class="text-area" [ngClass]="{\'pending\': responsePending}">\n    <span \n      #lastInput\n      autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"\n      id="input-span" \n      contenteditable\n      [innerHTML]="textHTMLstring"\n      [ngClass]="fontClass"\n      (input)="textChange($event.target.textContent)">\n    </span>\n    <span *ngIf="responsePending"><i class="fa fa-circle-o-notch fa-spin fa-fw"></i></span>\n    <span (click)="focusInput()"  (dblclick)="selectAll()" class="blank-input"></span>\n  </div>\n  <div (click)="focusInput()" (dblclick)="selectAll()" class="rest"></div>\n</div>',styles:["#input-area{color:#000;margin-top:10px;border-radius:5px;width:100%;border:1px solid #e3ecf7;overflow:hidden;padding:10px}.none{background-color:#f3f6fa}.xsmall{height:41px}.small{height:100px}.medium{height:250px}.large{height:500px}.xlarge{height:1000px}.text-area{display:flex;flex-wrap:wrap;max-width:100%}#input-span{max-width:100%;min-width:2px}#input-span:focus{outline:transparent solid 0}.blank-input{flex:1;width:100%}.rest{flex:1;flex-direction:column;width:100%;height:90%;max-height:230px}.focused{border:1px solid #647182!important}.pending{opacity:.3;color:gray!important}"]}]}],t.ctorParameters=function(){return[{type:e.Renderer2}]},t.propDecorators={targetItems:[{type:e.Input}],localAnalysis:[{type:e.Input}],boxHeight:[{type:e.Input}],fontClass:[{type:e.Input}],boxClass:[{type:e.Input}],boxFocus:[{type:e.Input}],initFocus:[{type:e.Input}],caseSensitive:[{type:e.Input}],currentText:[{type:e.Output}],lastInput:[{type:e.ViewChild,args:["lastInput"]}],inputBox:[{type:e.ViewChild,args:["inputBox"]}]},t}();function y(t,e){t.sort(function(t,e){return t.location[0]-e.location[0]});for(var n="",i=0,o=t[0].location[0],r=0;r<t.length;r++)0===i?(n=n+e.substring(i,o)+'<span class="'+t[r].css+'">'+t[r].text+"</span>",o=t[r].location[1]):n=n+'<span class="'+t[r].css+'">'+t[r].text+"</span>",t[r+1]&&(n+=e.substring(t[r].location[1],t[r+1].location[0]),i=t[r+1].location[0],o=t[r+1].location[1]),r===t.length-1&&(n+=e.substring(o,e.length));return console.log(n),n}var a=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[o.BrowserModule],declarations:[s],exports:[s]}]}],t}();t.NgInputHighlighterService=r,t.NgInputHighlighterComponent=s,t.NgInputHighlighterModule=a,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ng-input-highlighter.umd.min.js.map