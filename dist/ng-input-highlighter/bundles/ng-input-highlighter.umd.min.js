!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/platform-browser")):"function"==typeof define&&define.amd?define("ng-input-highlighter",["exports","@angular/core","rxjs","rxjs/operators","@angular/platform-browser"],e):e(t["ng-input-highlighter"]={},t.ng.core,t.rxjs,t.rxjs.operators,t.ng.platformBrowser)}(this,function(t,e,n,r,o){"use strict";var i=function(){function t(){}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=e.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}();function I(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}var s=function(){function t(t){this.renderer=t,this.regularClass=null,this.targetItems=[],this.localAnalysis=!0,this.caseSensitive=!1,this.currentText=new e.EventEmitter,this.textSubject=new n.Subject,this.responsePending=!1,this.textArray=[],this.tempString=""}return t.prototype.ngOnInit=function(){var e=this;this.textSubject.pipe(r.debounceTime(2e3)).subscribe(function(t){console.log(t),e.responsePending=!0,e.currentText.emit(e.tempString),e.localAnalysis&&(e.constructLocally(),setTimeout(function(){e.responsePending=!1,e.focusInput()},500))})},t.prototype.ngOnChanges=function(t){var e=this;0<this.targetItems.length&&!this.localAnalysis&&t.targetItems&&(console.log(t),this.constructExternally(),setTimeout(function(){e.responsePending=!1,e.focusInput()},500))},t.prototype.ngAfterViewInit=function(){var t=this;this.renderer.listen(this.lastInput.nativeElement,"focus",function(){t.renderer.addClass(t.inputBox.nativeElement,"focused")}),this.renderer.listen(this.lastInput.nativeElement,"blur",function(){t.renderer.removeClass(t.inputBox.nativeElement,"focused")}),this.focusInput(),console.log("targetItems",this.targetItems)},t.prototype.textChange=function(t){this.tempString=t,this.textSubject.next(t)},t.prototype.constructLocally=function(){var t='<span class="'+(this.regularClass?this.regularClass:"regTxt")+'">',e=function m(t,e,n){var r,o,i,s;if(n){e=e.toLowerCase();try{for(var a=I(t),l=a.next();!l.done;l=a.next()){var c=l.value;c.text=c.text.toLowerCase()}}catch(v){r={error:v}}finally{try{l&&!l.done&&(o=a["return"])&&o.call(a)}finally{if(r)throw r.error}}}var u=[];try{for(var p=I(t),f=p.next();!f.done;f=p.next()){var c=f.value,d=0,g=void 0,h=c.text.length;if(0===h)return"An error occurred. There appears to be no input search string.";for(;-1<(g=e.indexOf(c.text,d));){var x={text:c.text,location:[g,g+h],css:c.css};u.push(x),d=g+h}}}catch(y){i={error:y}}finally{try{f&&!f.done&&(s=p["return"])&&s.call(p)}finally{if(i)throw i.error}}return b(u,e)}(this.targetItems,this.tempString,this.caseSensitive);this.textHTMLstring=t+e+" </span>"},t.prototype.constructExternally=function(){var t,e,n,r;console.log(this.targetItems,this.tempString);var o='<span class="'+(this.regularClass?this.regularClass:"regTxt")+'">',i=!0,s=[];try{for(var a=I(this.targetItems),l=a.next();!l.done;l=a.next()){(d=l.value).location||(s.push(d),i=!1)}}catch(g){t={error:g}}finally{try{l&&!l.done&&(e=a["return"])&&e.call(a)}finally{if(t)throw t.error}}if(i){var c=b(this.targetItems,this.tempString);this.textHTMLstring=o+c+" </span>"}else{var u="";try{for(var p=I(s),f=p.next();!f.done;f=p.next()){var d;u=u+(d=f.value).text+"  "}}catch(h){n={error:h}}finally{try{f&&!f.done&&(r=p["return"])&&r.call(p)}finally{if(n)throw n.error}}this.textHTMLstring="An error occured.  The following items did not have a valid identified index location: "+u+"Either provide proper index locations of each item to be highlighted or set localAnalysis to true."}},t.prototype.focusInput=function(){console.log("focus"),this.lastInput&&(this.lastInput.nativeElement.focus(),this.placeCaretAtEnd(this.lastInput.nativeElement))},t.prototype.placeCaretAtEnd=function(t){if(t.focus(),"undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var e=document.createRange();e.selectNodeContents(t),e.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(e)}},t.decorators=[{type:e.Component,args:[{selector:"lib-ng-input-highlighter",template:'<div #inputBox id="input-area" tabindex="0">\n  <div class="text-area">\n      <span \n        #lastInput\n        autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"\n        id="input-span" \n        contenteditable\n        [innerHTML]="textHTMLstring"\n        [ngClass]="{\'pending\': responsePending}"\n        (input)="textChange($event.target.textContent)">\n      </span>\n      <span *ngIf="responsePending" style="margin-left:15px" class="spinner spinner-inline"></span>\n      <span (click)="focusInput()" class="blank-input"></span>\n  </div>\n  <div (click)="focusInput()" class="rest"></div>\n</div>',styles:["#input-area{color:#000;margin-top:10px;background-color:#f3f6fa;border-radius:5px;height:250px;width:100%;border:1px solid #e3ecf7;overflow:hidden;padding:10px}.text-area{display:flex;flex-wrap:wrap;max-width:100%}#input-span{max-width:100%;min-width:2px}#input-span:focus{outline:transparent solid 0}.blank-input{flex:1;width:100%}.rest{flex:1;flex-direction:column;width:100%;height:90%;max-height:230px}.focused{border:1px solid #647182!important}.pending{opacity:.3}"]}]}],t.ctorParameters=function(){return[{type:e.Renderer2}]},t.propDecorators={regularClass:[{type:e.Input}],targetItems:[{type:e.Input}],localAnalysis:[{type:e.Input}],caseSensitive:[{type:e.Input}],currentText:[{type:e.Output}],lastInput:[{type:e.ViewChild,args:["lastInput"]}],inputBox:[{type:e.ViewChild,args:["inputBox"]}]},t}();function b(t,e){t.sort(function(t,e){return t.location[0]-e.location[0]});for(var n="",r=0,o=t[0].location[0],i=0;i<t.length;i++)0===r?(n=n+e.substring(r,o)+'<span class="'+t[i].css+'">'+t[i].text+"</span>",o=t[i].location[1]):n=n+'<span class="'+t[i].css+'">'+t[i].text+"</span>",t[i+1]&&(n+=e.substring(t[i].location[1],t[i+1].location[0]),r=t[i+1].location[0],o=t[i+1].location[1]),i===t.length-1&&(n+=e.substring(o,e.length));return console.log(n),n}var a=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[o.BrowserModule],declarations:[s],exports:[s]}]}],t}();t.NgInputHighlighterService=i,t.NgInputHighlighterComponent=s,t.NgInputHighlighterModule=a,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ng-input-highlighter.umd.min.js.map